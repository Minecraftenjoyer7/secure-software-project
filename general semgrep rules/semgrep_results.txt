               
               
┌─────────────┐
│ Scan Status │
└─────────────┘
  Scanning 107 files tracked by git with 74 Code rules:
  Scanning 25 files with 68 js rules.
                    
                    
┌──────────────────┐
│ 22 Code Findings │
└──────────────────┘
                                                                      
    vuln-node.js-express.js-app/src/router/routes/New Folder 1/user.js
    ❯❱ javascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
          Details: https://sg.run/4xN9                                                                       
                                                                                                             
           18┆ const user_object = jwt.verify(req.headers.authorization.split(' ')[1],"SuperSecret")
            ⋮┆----------------------------------------
          259┆ var token = jwt.sign(payload, jwtTokenSecret, {
            ⋮┆----------------------------------------
          417┆ var jwttoken = jwt.sign(payload, jwtTokenSecret, {
                                                                    
    vuln-node.js-express.js-app/src/router/routes/New Folder/user.js
    ❯❱ javascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
          Details: https://sg.run/4xN9                                                                       
                                                                                                             
           18┆ const user_object = jwt.verify(req.headers.authorization.split(' ')[1],"SuperSecret")
            ⋮┆----------------------------------------
          253┆ var token = jwt.sign(payload, jwtTokenSecret, {
            ⋮┆----------------------------------------
          406┆ var jwttoken = jwt.sign(payload, jwtTokenSecret, {
                                                             
    vuln-node.js-express.js-app/src/router/routes/frontend.js
    ❯❱ javascript.express.security.express-insecure-template-usage.express-insecure-template-usage
          User data from `req` is being compiled into the template, which can lead to a Server Side Template
          Injection (SSTI) vulnerability.                                                                   
          Details: https://sg.run/b49v                                                                      
                                                                                                            
           18┆ rendered = nunjucks.renderString(message);
            ⋮┆----------------------------------------
           43┆ rendered = nunjucks.renderString(message);
                                                          
    vuln-node.js-express.js-app/src/router/routes/order.js
    ❯❱ javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal
          Possible writing outside of the destination, make sure that the target path is nested in the
          intended destination                                                                        
          Details: https://sg.run/weRn                                                                
                                                                                                      
           33┆ fs.readFile(path.join(__dirname, filePath),function(err,data){
   
   ❯❯❱ javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
          Details: https://sg.run/gjoe                                                                        
                                                                                                              
           71┆ const beers = db.sequelize.query(sql, { type: 'RAW' }).then(beers => {
                                                           
    vuln-node.js-express.js-app/src/router/routes/system.js
    ❯❱ javascript.express.security.audit.xss.direct-response-write.direct-response-write
          Detected directly writing to a Response object from user-defined input. This bypasses any HTML      
          escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use
          'resp.render()' to render safely escaped HTML.                                                      
          Details: https://sg.run/vzGl                                                                        
                                                                                                              
           18┆ res.send(test)
   
    ❯❱ javascript.express.security.audit.express-open-redirect.express-open-redirect
          The application redirects to a URL specified by user-supplied input `req` that is not validated.   
          This could redirect users to malicious locations. Consider using an allow-list approach to validate
          URLs, or warn users they are being redirected to a third-party website.                            
          Details: https://sg.run/EpoP                                                                       
                                                                                                             
           37┆ res.redirect(url);
   
    ❯❱ javascript.express.security.audit.express-third-party-object-deserialization.express-third-party-object-
       deserialization                                                                                         
          The following function call serialize.unserialize accepts user controlled data which can result in
          Remote Code Execution (RCE) through Object Deserialization. It is recommended to use secure data  
          processing alternatives such as JSON.parse() and Buffer.from().                                   
          Details: https://sg.run/8W5j                                                                      
                                                                                                            
           64┆ var deser = serialize.unserialize(body)
                                                         
    vuln-node.js-express.js-app/src/router/routes/user.js
    ❯❱ javascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
          Details: https://sg.run/4xN9                                                                       
                                                                                                             
           18┆ const user_object = jwt.verify(req.headers.authorization.split(' ')[1],"SuperSecret")
            ⋮┆----------------------------------------
          259┆ var token = jwt.sign(payload, jwtTokenSecret, {
            ⋮┆----------------------------------------
          417┆ var jwttoken = jwt.sign(payload, jwtTokenSecret, {
                                             
    vuln-node.js-express.js-app/src/server.js
    ❯❱ javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain
          Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it
          to compare against the domain of the server in which the URL is being requested. If they match, then
          check the path attribute next.                                                                      
          Details: https://sg.run/rd41                                                                        
                                                                                                              
           45┆ app.use(session({
           46┆   genid:function(req){
           47┆     if ( (req.session) && (req.session.uid) ) {
           48┆       return req.session.uid + "_" + 123;
           49┆       //    return new Date().getTime().toString();
           50┆
           51┆     } else {
           52┆       return new Date().getTime().toString();
           53┆     }
           54┆   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    ❯❱ javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires
          Default session middleware settings: `expires` not set. Use it to set expiration date for persistent
          cookies.                                                                                            
          Details: https://sg.run/N4eG                                                                        
                                                                                                              
           45┆ app.use(session({
           46┆   genid:function(req){
           47┆     if ( (req.session) && (req.session.uid) ) {
           48┆       return req.session.uid + "_" + 123;
           49┆       //    return new Date().getTime().toString();
           50┆
           51┆     } else {
           52┆       return new Date().getTime().toString();
           53┆     }
           54┆   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    ❯❱ javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly
          Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over
          HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.        
          Details: https://sg.run/ydBO                                                                    
                                                                                                          
           45┆ app.use(session({
           46┆   genid:function(req){
           47┆     if ( (req.session) && (req.session.uid) ) {
           48┆       return req.session.uid + "_" + 123;
           49┆       //    return new Date().getTime().toString();
           50┆
           51┆     } else {
           52┆       return new Date().getTime().toString();
           53┆     }
           54┆   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    ❯❱ javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-path
          Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to
          compare against the request path. If this and domain match, then send the cookie in the request.   
          Details: https://sg.run/b7pd                                                                       
                                                                                                             
           45┆ app.use(session({
           46┆   genid:function(req){
           47┆     if ( (req.session) && (req.session.uid) ) {
           48┆       return req.session.uid + "_" + 123;
           49┆       //    return new Date().getTime().toString();
           50┆
           51┆     } else {
           52┆       return new Date().getTime().toString();
           53┆     }
           54┆   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    ❯❱ javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure
          Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie
          over HTTPS.                                                                                        
          Details: https://sg.run/9oKz                                                                       
                                                                                                             
           45┆ app.use(session({
           46┆   genid:function(req){
           47┆     if ( (req.session) && (req.session.uid) ) {
           48┆       return req.session.uid + "_" + 123;
           49┆       //    return new Date().getTime().toString();
           50┆
           51┆     } else {
           52┆       return new Date().getTime().toString();
           53┆     }
           54┆   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    ❯❱ javascript.express.security.audit.express-session-hardcoded-secret.express-session-hardcoded-secret
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
          Details: https://sg.run/LYvG                                                                       
                                                                                                             
           59┆ secret: 'SuperSecret',
                
                
┌──────────────┐
│ Scan Summary │
└──────────────┘
✅ Scan completed successfully.
 • Findings: 22 (22 blocking)
 • Rules run: 68
 • Targets scanned: 25
 • Parsed lines: ~100.0%
 • Scan skipped: 
   ◦ Files matching .semgrepignore patterns: 395
 • For a detailed list of skipped files and lines, run semgrep with the --verbose flag
Ran 68 rules on 25 files: 22 findings.

A new version of Semgrep is available. See https://semgrep.dev/docs/upgrading

